@model List<cansaraciye_ecommerce.Models.Order>
@{
    ViewData["Title"] = "SipariÅŸ YÃ¶netimi";
}

<div class="container py-4">
    <div class="card shadow border-0 rounded-4 mb-4">
        <div class="card-body px-4 py-4">
            <h3 class="fw-bold mb-4">ðŸ“¦ SipariÅŸ YÃ¶netimi</h3>

            <!-- Filtre Formu -->
            <form method="get" class="mb-3">
                <div class="row g-3">
                    <!-- Durum Filtresi -->
                    <div class="col-md-4">
                        <label class="form-label">SipariÅŸ Durumu</label>
                        <select name="statusFilter" class="form-select" onchange="this.form.submit()">
                            <option value="TÃ¼mÃ¼" selected="@(ViewBag.StatusFilter == "TÃ¼mÃ¼" ? "selected" : null)">TÃ¼mÃ¼
                            </option>
                            <option value="Onay Bekleniyor"
                                selected="@(ViewBag.StatusFilter == "Onay Bekleniyor" ? "selected" : null)">Onay
                                Bekleniyor</option>
                            <option value="OnaylandÄ±"
                                selected="@(ViewBag.StatusFilter == "OnaylandÄ±" ? "selected" : null)">OnaylandÄ±</option>
                            <option value="Kargoya Verildi"
                                selected="@(ViewBag.StatusFilter == "Kargoya Verildi" ? "selected" : null)">Kargoya
                                Verildi</option>
                            <option value="Teslim Edildi"
                                selected="@(ViewBag.StatusFilter == "Teslim Edildi" ? "selected" : null)">Teslim Edildi
                            </option>
                            <option value="Ä°ptal Edildi"
                                selected="@(ViewBag.StatusFilter == "Ä°ptal Edildi" ? "selected" : null)">Ä°ptal Edildi
                            </option>
                        </select>
                    </div>

                    <!-- Tarih SÄ±ralama -->
                    <div class="col-md-4">
                        <label class="form-label">Tarihe GÃ¶re SÄ±ralama</label>
                        <select name="sortOrder" class="form-select" onchange="this.form.submit()">
                            <option value="newest" selected="@(ViewBag.SortOrder == "newest" ? "selected" : null)">En
                                Yeni Ã–nce</option>
                            <option value="oldest" selected="@(ViewBag.SortOrder == "oldest" ? "selected" : null)">En
                                Eski Ã–nce</option>
                        </select>
                    </div>

                    <!-- Buton -->
                    <div class="col-md-4 d-flex align-items-end">
                        <button type="submit" class="btn btn-dark w-100"><i
                                class="bi bi-funnel me-1"></i>Filtrele</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- SipariÅŸ Listesi -->
    <div class="card shadow border-0 rounded-4">
        <div class="card-body px-4 py-4">
            <div class="table-responsive">
                <table class="table table-bordered text-center align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>SipariÅŸ No</th>
                            <th>KullanÄ±cÄ±</th>
                            <th>Tarih</th>
                            <th>Toplam Fiyat</th>
                            <th>Durum</th>
                            <th>Ä°ÅŸlemler</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var order in Model)
                        {
                            <tr>
                                <td class="fw-semibold">#@order.Id</td>
                                <td>@order.FullName</td>
                                <td>@order.OrderDate.ToString("dd.MM.yyyy")</td>
                                <td>@order.OrderItems.Sum(i => i.TotalPrice).ToString("C")</td>
                                <td>
                                    <span class="badge bg-secondary">@order.Status</span>
                                </td>
                                <td>
                                    <a asp-action="OrderDetails" asp-route-id="@order.Id"
                                        class="btn btn-sm btn-outline-primary me-1">
                                        <i class="bi bi-eye"></i> Detaylar
                                    </a>
                                    <a asp-action="DeleteOrder" asp-route-id="@order.Id"
                                        class="btn btn-sm btn-outline-danger"
                                        onclick="return confirm('Bu sipariÅŸi silmek istediÄŸinize emin misiniz?');">
                                        <i class="bi bi-trash"></i> Sil
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
